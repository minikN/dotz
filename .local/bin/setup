#!/bin/sh

### Initial setup for dotfiles
###
### After cloning this repo, set execution bit on this file.
### Then, in the root dir of the repo, run
###
### .local/bin/setup .config/packages
###
### This will install all packages defined in .config/packages,
### activate services and symlink all dot files. After that,
### dont' runt this file again. Instead, run `sp` to sync
### packages.

# Sync packages
echo "Syncing packages ..."
chmod +x .local/bin/sp
.local/bin/sp $1

# Window manager
if ! command -v ly &> /dev/null
then
	echo "Installing window manager ..."
	git clone --recurse-submodules https://github.com/fairyglade/ly /tmp/ly
	cd /tmp/ly
	make
	sudo make install installsystemd
	sudo systemctl enable ly
	exit
fi

# Enable services
sudo systemctl enable acpid
sudo systemctl enable avahi-daemon

# Symlinking
stow . -t ~/
